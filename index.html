<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cadastro de Alunos — Notas e Médias</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <header>
        <h1>Cadastro de Alunos</h1>
        <div class="subtitle">Armazenar nomes, notas e médias — busca sequencial e normalização de nomes</div>
    </header>

    <main>
        <div class="card">
            <label for="nome">Nome do aluno</label>
            <input id="nome" placeholder="Ex.: maria silva" />

            <label for="nota1">Nota 1</label>
            <input id="nota1" type="number" step="0.01" min="0" max="10" placeholder="0 - 10" />

            <label for="nota2">Nota 2</label>
            <input id="nota2" type="number" step="0.01" min="0" max="10" placeholder="0 - 10" />

            <label for="nota3">Nota 3</label>
            <input id="nota3" type="number" step="0.01" min="0" max="10" placeholder="0 - 10" />

            <div style="margin-top:10px;">
                <button id="btnAdicionar">Adicionar / Atualizar aluno</button>
                <button id="btnCalcularTodas">Calcular médias (todas)</button>
                <button id="btnLimpar">Limpar lista</button>
            </div>
        </div>

        <div class="card" style="margin-top:15px;">
            <label for="busca">Buscar aluno por nome</label>
            <input id="busca" placeholder="Digite o nome para buscar (ex.: Maria Silva)" />
            <button id="btnBuscar">Buscar</button>

            <table class="table" id="tabelaAlunos">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Nota 1</th>
                        <th>Nota 2</th>
                        <th>Nota 3</th>
                        <th>Média</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Linhas geradas por JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="footer">
            <small>Feito com HTML, CSS e JavaScript — tema Azul & Branco</small>
        </div>
    </main>
    <script>
        const alunos = [];

        // Função para atualizar a tabela de alunos
        function atualizarTabela() {
            const tbody = document.querySelector('#tabelaAlunos tbody');
            tbody.innerHTML = "";

            if (alunos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Nenhum aluno cadastrado ainda.</td></tr>';
                return;
            }

            alunos.forEach((aluno, index) => {
                const linha = document.createElement("tr");

                linha.innerHTML = `
      <td>${aluno.nome}</td>
      <td>${isNaN(aluno.notas[0]) ? '-' : aluno.notas[0]}</td>
      <td>${isNaN(aluno.notas[1]) ? '-' : aluno.notas[1]}</td>
      <td>${isNaN(aluno.notas[2]) ? '-' : aluno.notas[2]}</td>
      <td>${aluno.media || '-'}</td>
    `;

                tbody.appendChild(linha);
            });
        }

        // Função para formatar nomes
        function formatarNome(nome) {
            return nome
                .trim()
                .toLowerCase()
                .split(' ')
                .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
                .join(' ');
        }

        // Adicionar aluno
        document.getElementById("btnAdicionar").addEventListener("click", () => {
            const nome = formatarNome(document.getElementById("nome").value);
            const nota1 = parseFloat(document.getElementById("nota1").value);
            const nota2 = parseFloat(document.getElementById("nota2").value);
            const nota3 = parseFloat(document.getElementById("nota3").value);

            if (!nome) {
                alert("Digite o nome do aluno!");
                return;
            }

            // Verifica se o aluno já existe
            const alunoExistente = alunos.find(a => a.nome === nome);
            if (alunoExistente) {
                alunoExistente.notas = [nota1, nota2, nota3];
                alunoExistente.media = null; // Reseta a média
            } else {
                alunos.push({
                    nome,
                    notas: [nota1, nota2, nota3],
                    media: null
                });
            }

            // Limpa os campos
            document.getElementById("nome").value = "";
            document.getElementById("nota1").value = "";
            document.getElementById("nota2").value = "";
            document.getElementById("nota3").value = "";

            atualizarTabela();
            alert('Aluno "' + nome + '" ' + (alunoExistente ? 'atualizado' : 'cadastrado') + ' com sucesso!');
        });

        // Calcular médias
        document.getElementById("btnCalcularTodas").addEventListener("click", () => {
            if (alunos.length === 0) {
                alert("Nenhum aluno cadastrado para calcular médias!");
                return;
            }

            alunos.forEach(aluno => {
                let soma = 0;
                let notasValidas = 0;

                aluno.notas.forEach(nota => {
                    if (!isNaN(nota)) {
                        soma += nota;
                        notasValidas++;
                    }
                });

                aluno.media = notasValidas > 0 ? (soma / notasValidas).toFixed(2) : '-';
            });

            atualizarTabela();
            alert("Médias calculadas para todos os alunos!");
        });

        // Buscar aluno
        document.getElementById("btnBuscar").addEventListener("click", () => {
            const nomeBusca = formatarNome(document.getElementById("busca").value);

            if (!nomeBusca) {
                alert("Digite um nome para buscar!");
                return;
            }

            const alunoEncontrado = alunos.find(a => a.nome === nomeBusca);

            if (alunoEncontrado) {
                alert('Aluno encontrado!\nNome: ' + alunoEncontrado.nome + '\nNotas: ' + alunoEncontrado.notas.map(n => isNaN(n) ? '-' : n).join(', ') + '\nMédia: ' + (alunoEncontrado.media || 'Não calculada'));
            } else {
                alert("Aluno não encontrado!");
            }
        });

        // Limpar lista
        document.getElementById("btnLimpar").addEventListener("click", () => {
            if (alunos.length === 0) {
                alert("A lista já está vazia!");
                return;
            }

            if (confirm("Tem certeza que deseja limpar toda a lista de alunos?")) {
                alunos.length = 0;
                atualizarTabela();
                alert("Lista de alunos limpa com sucesso!");
            }
        });

        // Inicializa a tabela
        atualizarTabela();
    </script>

    <script src="script.js"></script>
</body>

</html>